{% extends "index.html" %}

{% block title %}
    Profile
{% endblock %}

{% block links %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
{% endblock %}

{% block content %}
    <main>
        <div class="profile-form-wrapper">
            <h3 class="form-header">Update your info</h3>
            <form class="profile-form" method="POST" action="/profile"  enctype="multipart/form-data" >
                <div class="form-group">
                    <div class="form-group-item">
                        <label class="form-label">        name:  </label>
                        <div class="form-input-group">
                            <button type="button" class="form-input-edit-btn">edit</button>
                            <input readonly class="form-input" value="{% if user.name %}{{user.name}}{% endif %}" required type="text" name="name" />
                        </div>
                    </div>
                    <div class="form-group-item">
                        <label class="form-label">        age: </label>
                        <div class="form-input-group">
                            <button type="button" class="form-input-edit-btn">edit</button>
                            <input readonly class="form-input" value="{% if user.age != 0 %}{{user.age}}{% endif %}"  required type="number" name="age" min="18" max="100" />
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">        email: </label>
                    <div class="form-input-group">
                            <button type="button" class="form-input-edit-btn">edit</button>
                        <input readonly class="form-input" value="{{user.email}}" required type="email" name="email" />
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">        old password: </label>
                    <div class="form-input-group">
                        <input class="form-input" type="password" name="oldpassw" />
                        <i class="fa-solid fa-eye password-visibility-icon"></i>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">        new password: </label>
                    <div class="form-input-group">
                        <input class="form-input" type="password" name="newpassw" />
                        <i class="fa-solid fa-eye password-visibility-icon"></i>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">        bio: </label>
                    <div class="form-input-group">
                            <button type="button" class="form-input-edit-btn">edit</button>
                        <textarea readonly class="form-input" type="text" name="bio">{% if user.bio %}{{user.bio}}{% endif %}</textarea>
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-group-item">
                        <label class="form-label">
                            gender:
                        </label>
                        <button type="button" class="form-input-edit-btn">edit</button>
                        <div class="radio-group">
                            <label for="male">male </label>   
                            <input {% if user.gender == 1%}checked{% endif %} disabled class="form-radio" name="gender" id="male" type="radio" value="1" />
                        </div>
                        <div class="radio-group">
                            <label for="female">female</label>
                            <input {% if user.gender == 0%}checked{% endif %} disabled class="form-radio" name="gender" id="female" type="radio" value="0" />    
                            <input type="hidden" name="gender" value="1" id="hidden-male" />
                            <input type="hidden" name="gender" value="0" id="hidden-female" />
                        </div>
                    </div>
                    <div class="form-group-item">
                        <label class="form-label">
                            profile picture:
                        </label>
                        {% if user.profile_pic %}
                            <a href="/profile/picture/{{user.id}}" class="form-input-edit-btn show-img-btn">show</a>
                             <div class="form-input-edit-btn show-delete-popup-btn">delete</div>
                             {# <button type="button" class="form-input-edit-btn">show</button>
                            <button type="button" class="form-input-edit-btn">delete</button> #}
                            {% else %}
                            <!-- <form class="add-img-form" method="POST" action="/profile/picture/{{user.id}}"> -->
                            <!-- </form> -->
                              <input type="file" value="add" name="profile_pic" class="form-input-edit-btn" placeholder="upload" alt="upload your profile picture"/>
                        {% endif %}
                        
                    </div>
                </div>
                <div class="msg">
                    <div class="error">
                        {% with messages = get_flashed_messages(with_categories=True) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                    {% if category == "error" %}
                                        <div class="error-msg">* {{message}}</div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                    </div>
                    <div class="success">
                        {% with messages = get_flashed_messages(with_categories=True) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                    {% if category == "success" %}
                                        <div class="success-msg">* {{message}}</div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                    </div>
                </div>
                <input type="submit" class="profile-save-btn" value="SAVE INFO"/>
            </form>
            <div class="popup-modal">
                <div class="delete-picture-popup">
                  <div class="delete-confirm-text">are you sure you want to delete your profile picture, this action is irreversible </div>
                  <div class="popup-btns">
                    <button type="submit" class="delete-profile-pic-confirm-btn">confirm</button>
                    <button type="reset" class="cancel-delete-profile-pic-btn">cancel</button>
                  </div>
                </div>
            </div>
        </div>
    </main>
    {% block scripts %}

        <script>
            const user = {{ user | tojson }};
        </script>
        <script src="js/profile.js"></script>
        <script src="js/index.js"></script>
    {% endblock %}
{% endblock %}